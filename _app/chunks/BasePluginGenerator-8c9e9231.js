import{C as u}from"./Class-8b746327.js";import{U as a,M as t,V as i,a as o,F as r}from"./Field-fc1f35c8.js";import{F as l,g}from"./index-f87cc2aa.js";import{F as p}from"./File-9e84454c.js";import"./vendor-83d19bf2.js";import"./preload-helper-ec9aa979.js";class m{generate(e){const n=e.base.pluginName+"Plugin";return new p(n,"cs",[],this.generateBasePluginClassContent(e,n))}generateBasePluginClassContent(e,n){const s=new u(e.base.nameSpace,n);return s.usings.push(new a("Nop.Services.Plugins")),s.usings.push(new a("System.Threading.Tasks")),e.settings.enabled&&(s.usings.push(new a("Nop.Services.Localization")),s.usings.push(new a("Nop.Services.Configuration"))),s.inheritsFrom="BasePlugin",this.generateBasePluginClassConfigurationPageUrl(e,s),this.generateBasePluginClassInstallMethod(e,s),this.generateBasePluginClassUninstallMethod(s),s.toString()}generateBasePluginClassUninstallMethod(e){const n=new t(i.Public,"UninstallAsync",!0);e.methods.push(n),n.expressions.push("await base.UninstallAsync();")}generateBasePluginClassInstallMethod(e,n){const s=new t(i.Public,"InstallAsync",!0);n.methods.push(s),e.settings.enabled&&(this.addLocalResources(s,n),this.initializeDefaultSettings(s,e,n)),s.expressions.push(""),s.expressions.push("await base.InstallAsync();")}initializeDefaultSettings(e,n,s){e.expressions.push(""),e.expressions.push(`await _settingService.SaveSettingAsync(new ${n.base.pluginName}Settings()`),e.expressions.push("{"),e.expressions.push(`${o(1)}// todo: set default values of settings here`),e.expressions.push("});"),s.addField(new r(i.Private,l+"settingService","ISettingService",{hasGetterAndSetter:!1,isConstant:!1,isReadonly:!0,additionalNewLine:!1}))}addLocalResources(e,n){n.usings.push(new a("System.Collections.Generic")),e.expressions.push("await _localizationService.AddLocaleResourceAsync(new Dictionary<string, string>"),e.expressions.push("{"),g().forEach(s=>{e.expressions.push(`${o(1)}["${s.name}"] = "${s.value}",`)}),e.expressions.push("});"),n.addField(new r(i.Private,l+"localizationService","ILocalizationService",{hasGetterAndSetter:!1,isConstant:!1,isReadonly:!0,additionalNewLine:!1}))}generateBasePluginClassConfigurationPageUrl(e,n){n.usings.push(new a("Nop.Core")),n.addField(new r(i.Private,l+"webHelper","IWebHelper",{hasGetterAndSetter:!1,isConstant:!1,isReadonly:!0,additionalNewLine:!1}));const s=new t(i.Public,"GetConfigurationPageUrl",!0,!1,"string");n.methods.push(s),s.expressions.push(`return $"{_webHelper.GetStoreLocation()}Admin/${e.base.pluginName}/Configure";`)}}export{m as default};
