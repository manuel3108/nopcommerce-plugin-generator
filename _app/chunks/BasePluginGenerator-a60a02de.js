import{C as u}from"./Class-94388e80.js";import{U as n,M as t,V as i,F as r}from"./Field-a8c2a7c7.js";import{a as l,F as o,d as p,D as d}from"./index-5f5ec556.js";import{F as g}from"./File-9e84454c.js";import"./vendor-3e99503a.js";import"./preload-helper-ec9aa979.js";class m{generate(e){const a=e.base.pluginName+"Plugin";return new g(a,"cs",[],this.generateBasePluginClassContent(e,a))}generateBasePluginClassContent(e,a){const s=new u(e.base.nameSpace,a,{addCtor:!0,addRegions:!0});return s.usings.push(new n("Nop.Services.Plugins")),s.usings.push(new n("System.Threading.Tasks")),e.settings.enabled&&(s.usings.push(new n("Nop.Services.Localization")),s.usings.push(new n("Nop.Services.Configuration"))),s.inheritsFrom="BasePlugin",this.generateBasePluginClassConfigurationPageUrl(e,s),this.generateBasePluginClassInstallMethod(e,s),this.generateBasePluginClassUninstallMethod(s),s.toString()}generateBasePluginClassUninstallMethod(e){const a=new t(i.Public,"UninstallAsync",{override:!0,async:!0,returnType:"Task"});e.methods.push(a),a.expressions.push("await base.UninstallAsync();")}generateBasePluginClassInstallMethod(e,a){const s=new t(i.Public,"InstallAsync",{override:!0,async:!0,returnType:"Task"});a.methods.push(s),e.settings.enabled&&(this.addLocalResources(s,a),this.initializeDefaultSettings(s,e,a)),s.expressions.push(""),s.expressions.push("await base.InstallAsync();")}initializeDefaultSettings(e,a,s){e.expressions.push(""),e.expressions.push(`await _settingService.SaveSettingAsync(new ${a.base.pluginName}Settings()`),e.expressions.push("{"),e.expressions.push(`${l(1)}// todo: set default values of settings here`),e.expressions.push("});"),s.addField(new r(i.Private,o+"settingService","ISettingService",{hasGetterAndSetter:!1,isConstant:!1,isReadonly:!0,additionalNewLine:!1}))}addLocalResources(e,a){a.usings.push(new n("System.Collections.Generic")),e.expressions.push("await _localizationService.AddLocaleResourceAsync(new Dictionary<string, string>"),e.expressions.push("{"),p().forEach(s=>{e.expressions.push(`${l(1)}["${s.name}"] = "${s.value}",`)}),e.expressions.push("});"),a.addField(new r(i.Private,o+"localizationService","ILocalizationService",{hasGetterAndSetter:!1,isConstant:!1,isReadonly:!0,additionalNewLine:!1}))}generateBasePluginClassConfigurationPageUrl(e,a){a.usings.push(new n("Nop.Core")),a.addField(new r(i.Private,o+"webHelper","IWebHelper",{hasGetterAndSetter:!1,isConstant:!1,isReadonly:!0,additionalNewLine:!1}));const s=new t(i.Public,"GetConfigurationPageUrl",{override:!0,async:!1,returnType:d.String});a.methods.push(s),s.expressions.push(`return $"{_webHelper.GetStoreLocation()}Admin/${e.base.pluginName}Configuration/Configure";`)}}export{m as default};
