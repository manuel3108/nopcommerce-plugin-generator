import{C as u}from"./Class-b52043a1.js";import{F as i}from"./Field-93ddfcbf.js";import{U as t,M as r,V as n}from"./ClassBase-8dcc53a8.js";import{a as l,F as o,e as p,D as g}from"./index-b0b0fd3f.js";import{F as d}from"./File-9e84454c.js";import"./vendor-ee3c6b4b.js";import"./preload-helper-ec9aa979.js";class y{generate(e){const a=e.base.pluginName+"Plugin";return[new d(a,"cs",[],this.generateBasePluginClassContent(e,a))]}generateBasePluginClassContent(e,a){const s=new u(e.base.nameSpace,a,{addCtor:!0,addRegions:!0});return s.usings.push(new t("Nop.Services.Plugins")),s.usings.push(new t("System.Threading.Tasks")),e.settings.properties.length>0&&(s.usings.push(new t("Nop.Services.Localization")),s.usings.push(new t("Nop.Services.Configuration"))),s.inheritsFrom="BasePlugin",this.generateBasePluginClassConfigurationPageUrl(e,s),this.generateBasePluginClassInstallMethod(e,s),this.generateBasePluginClassUninstallMethod(s),s.toString()}generateBasePluginClassUninstallMethod(e){const a=new r(n.Public,"UninstallAsync",{override:!0,async:!0,returnType:"Task"});e.methods.push(a),a.expressions.push("await base.UninstallAsync();")}generateBasePluginClassInstallMethod(e,a){const s=new r(n.Public,"InstallAsync",{override:!0,async:!0,returnType:"Task"});a.methods.push(s),e.settings.properties.length>0&&(this.addLocalResources(s,a),this.initializeDefaultSettings(s,e,a)),s.expressions.push(""),s.expressions.push("await base.InstallAsync();")}initializeDefaultSettings(e,a,s){e.expressions.push(""),e.expressions.push(`await _settingService.SaveSettingAsync(new ${a.base.pluginName}Settings()`),e.expressions.push("{"),e.expressions.push(`${l(1)}// todo: set default values of settings here`),e.expressions.push("});"),s.addField(new i(n.Private,o+"settingService","ISettingService",{hasGetterAndSetter:!1,isConstant:!1,isReadonly:!0,additionalNewLine:!1,isProperty:!1}))}addLocalResources(e,a){a.usings.push(new t("System.Collections.Generic")),e.expressions.push("await _localizationService.AddLocaleResourceAsync(new Dictionary<string, string>"),e.expressions.push("{"),p().forEach(s=>{e.expressions.push(`${l(1)}["${s.name}"] = "${s.value}",`)}),e.expressions.push("});"),a.addField(new i(n.Private,o+"localizationService","ILocalizationService",{hasGetterAndSetter:!1,isConstant:!1,isReadonly:!0,additionalNewLine:!1,isProperty:!1}))}generateBasePluginClassConfigurationPageUrl(e,a){a.usings.push(new t("Nop.Core")),a.addField(new i(n.Private,o+"webHelper","IWebHelper",{hasGetterAndSetter:!1,isConstant:!1,isReadonly:!0,additionalNewLine:!1,isProperty:!1}));const s=new r(n.Public,"GetConfigurationPageUrl",{override:!0,async:!1,returnType:g.String});a.methods.push(s),s.expressions.push(`return $"{_webHelper.GetStoreLocation()}Admin/${e.base.pluginName}Configuration/Configure";`)}}export{y as default};
